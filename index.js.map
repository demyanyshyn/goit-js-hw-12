{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export default class RenderGallery {\n  constructor() {\n    this.gallery = document.querySelector(`.gallery`);\n  }\n  changeResolution(img) {\n    return img.replace('_640', `_180`);\n  }\n  showFirstPage(response) {\n    this.#renderItems(response);\n  }\n  showNextPage(response) {\n    this.#renderItems(response);\n  }\n  #renderItems(response) {\n    const markup = response.data.hits\n      .map(image => {\n        return `<li class=\"gallery-item\">\n        <div clas=\"img-box\">\n          <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${this.changeResolution(image.webformatURL)}\"\n              data-source=\"${image.largeImageURL}\"\n              alt=\"${image.tags}\"\n            />\n          </a>\n        </div>\n        <ul class=\"content-box\">\n          <li class=\"content-item\">\n            <div class=\"content-header\">Likes</div>\n            <div class=\"content\">${image.likes}</div>\n          </li>\n          <li class=\"content-item\">\n           <div class=\"content-header\">Views</div>\n            <div class=\"content\">${image.views}</div>\n          </li>\n          <li class=\"content-item\">\n            <div class=\"content-header\">Comments</div>\n            <div class=\"content\">${image.comments}</div>\n          </li>\n          <li class=\"content-item\">\n            <div class=\"content-header\">Downloads</div>\n            <div class=\"content\">${image.downloads}</div>\n          </li>\n        </ul>\n      </li>\n      `;\n      })\n      .join('');\n\n    this.gallery.insertAdjacentHTML('beforeend', markup);\n  }\n\n  clearGalery() {\n    this.gallery.innerHTML = ``;\n    this.removeBtn();\n  }\n\n  createBtn(callback, callback2) {\n    const div = document.createElement(`div`);\n    div.classList.add(`pages-btn-wrapper`);\n    div.innerHTML = `\n      <buton class=\"search-btn\" id=\"next-page\" type=\"button\">Load more</buton>\n      <buton class=\"search-btn\" id=\"last-page\" type=\"button\">Load last page</buton>`;\n    const nextBtn = div.querySelector(`#next-page`);\n    const lastBtn = div.querySelector(`#last-page`);\n    nextBtn.addEventListener(`click`, callback);\n    lastBtn.addEventListener(`click`, callback2);\n\n    this.gallery.insertAdjacentElement(`afterend`, div);\n  }\n  removeBtn() {\n    const btn = document.querySelectorAll(`.pages-btn-wrapper`);\n    btn ? btn.forEach(el => el.remove()) : ``;\n  }\n\n  loader() {\n    const loader = `<div class=\"content-header\" id=\"loader\">Loading images, please wait... <br/><span class=\"loader\"></span></div>`;\n    this.gallery.insertAdjacentHTML('afterend', loader);\n  }\n  removeLoader() {\n    const loader = document.querySelector(`#loader`);\n    loader.remove();\n  }\n  disableBtn(callback, callback2) {\n    const nextBtn = document.querySelector(`#next-page`);\n    const lastBtn = document.querySelector(`#last-page`);\n    nextBtn.removeEventListener(`click`, callback);\n    lastBtn.removeEventListener(`click`, callback2);\n    nextBtn.classList.toggle(`disabled-btn`);\n    lastBtn.classList.toggle(`disabled-btn`);\n\n    // const div = document.querySelector(`.pages-btn-wrapper`);\n    // div.remove();\n  }\n}\n","import axios from 'axios';\n\n// classes\nexport default class ImageQuery {\n  #options;\n  #url;\n\n  constructor() {\n    this.#options = {\n      params: {\n        _method: 'get',\n        key: `49061032-8122651df51dcd062279bc436`,\n        q: ``,\n        orientation: `horizontal`,\n        page: 1,\n        safesearch: true,\n        image_type: `photo`,\n        per_page: 40,\n      },\n    };\n    this.#url = `https://pixabay.com/api/`;\n    this.lastP = 0;\n  }\n  async sendQuery(searchInput, page) {\n    searchInput ? (this.#options.params.q = searchInput) : ``;\n    const response = await axios(this.#url, this.#options);\n\n    return response;\n  }\n  async goToLastPage() {\n    this.#options.params.page = this.lastP;\n    const response = await this.sendQuery();\n    return response;\n  }\n  clearSearchQuery() {\n    this.#options.params.q = ``;\n    this.#options.params.page = 1;\n  }\n  nextPage() {\n    this.#options.params.page++;\n  }\n  lastPage(response) {\n    this.lastP = Math.ceil(\n      response.data.totalHits / this.#options.params.per_page\n    );\n    return this.lastP <= this.#options.params.page;\n  }\n}\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n// my inport\nimport RenderGallery from './js/render-functions';\nimport ImageQuery from './js/pixabay-api';\n\nconst optionsSimpleLightBox = {\n  captionDelay: 250,\n  captionsData: 'alt',\n};\n\nfunction getOn() {\n  form.addEventListener(`submit`, event => search(event));\n}\nasync function search(event) {\n  event.preventDefault();\n  if (isValidInput()) {\n    refresh();\n    gallery.loader();\n    const id = setTimeout(async () => {\n      try {\n        const response = await pixABay.sendQuery(searchInput);\n        renderFirstPage(response);\n        pixABay.nextPage();\n      } catch (error) {\n        errorShow(error);\n      }\n      clearInterval(id);\n    }, 2000);\n  } else {\n    errorShow(`Sorry, input not valid`);\n    refresh();\n  }\n}\nasync function loadMore(event) {\n  gallery.loader();\n  const id = setTimeout(async () => {\n    try {\n      const response = await pixABay.sendQuery();\n      pixABay.nextPage();\n      renderNexPage(response);\n    } catch (error) {\n      errorShow(error);\n    }\n    clearInterval(id);\n  }, 2000);\n}\n\nasync function loadLast(event) {\n  gallery.loader();\n  const id = setTimeout(async () => {\n    try {\n      const response = await pixABay.goToLastPage();\n      renderNexPage(response);\n    } catch (error) {\n      errorShow(error);\n    }\n    clearInterval(id);\n  }, 2000);\n}\n\nfunction isValidInput() {\n  if (input.value && input.value.length <= 100) {\n    searchInput = input.value;\n    return true;\n  } else return false;\n}\n\nfunction renderNexPage(response) {\n  gallery.removeLoader();\n  gallery.showNextPage(response);\n  galleryLight.refresh();\n  scroll();\n  if (pixABay.lastPage(response)) {\n    gallery.disableBtn(loadMore, loadLast);\n    iziToast.warning({\n      message: `We're sorry, but you've reached the end of search results.\n`,\n      position: `topRight`,\n    });\n  }\n}\n\nfunction renderFirstPage(response) {\n  gallery.removeLoader();\n  if (response.data.hits.length > 0) {\n    gallery.clearGalery();\n    gallery.showFirstPage(response);\n    gallery.createBtn(loadMore, loadLast);\n    galleryLight.refresh();\n\n    if (pixABay.lastPage(response)) {\n      gallery.disableBtn(loadMore, loadLast);\n      iziToast.warning({\n        message: `We're sorry, but you've reached the end of search results.\n`,\n        position: `topRight`,\n      });\n    }\n  } else {\n    errorShow(`Sorry, there are no images matching your search query. Please try again!\n  `);\n    gallery.clearGalery();\n  }\n}\nfunction scroll() {\n  const item = document.querySelector(`.gallery-item`);\n  let itemParams = item.getBoundingClientRect();\n  window.scrollBy({\n    top: itemParams.height * 2,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n\nfunction refresh() {\n  gallery.clearGalery();\n  input.value = ``;\n  pixABay.clearSearchQuery();\n}\n\nfunction errorShow(message) {\n  message = message.message ? message.message : message;\n  let errorMessage = {\n    message,\n    icon: `material-icons-outlined`,\n    iconColor: '#fff',\n    iconText: `dangerous`,\n    messageColor: `#fff`,\n    color: `#ef4040`,\n    position: `topRight`,\n    timeout: 2000,\n    theme: `dark`,\n    maxWidth: `432px`,\n  };\n  iziToast.show(errorMessage);\n}\n\nconst gallery = new RenderGallery();\nconst pixABay = new ImageQuery();\nlet galleryLight = new SimpleLightbox('.gallery-link', optionsSimpleLightBox);\n\nconst form = document.querySelector(`#search-form`);\nconst btn = document.querySelector(`#search-btn`);\nconst input = document.querySelector(`#search-input`);\n\nlet searchInput;\n\ngetOn();\n"],"names":["RenderGallery","__privateAdd","_RenderGallery_instances","img","response","__privateMethod","renderItems_fn","callback","callback2","div","nextBtn","lastBtn","btn","el","markup","image","ImageQuery","_options","_url","__privateSet","searchInput","page","__privateGet","axios","optionsSimpleLightBox","getOn","form","event","search","isValidInput","refresh","gallery","id","pixABay","renderFirstPage","error","errorShow","loadMore","renderNexPage","loadLast","input","galleryLight","scroll","iziToast","itemParams","message","errorMessage","SimpleLightbox"],"mappings":"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"}